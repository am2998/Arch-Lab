#!/usr/bin/env python3
# ZFS Assistant - AppImage Entry Point
# Author: am2998

"""
Entry point for the ZFS Assistant AppImage.
This script is used when the application is run from the AppImage.
"""

import os
import sys
import gi

# Ensure we're using the correct GTK version
gi.require_version('Gtk', '4.0')
gi.require_version('Adw', '1')

def main():
    """Main entry point for the AppImage."""
    try:
        # Get the AppImage directory
        appdir = os.environ.get('APPDIR', os.path.dirname(os.path.abspath(__file__)))
        
        # Add the application source to Python path
        src_path = os.path.join(appdir, 'usr', 'src')
        if src_path not in sys.path:
            sys.path.insert(0, src_path)
        
        # Import and run the application
        from zfs_assistant import main as app_main
        return app_main()
        
    except ImportError as e:
        print(f"Error importing ZFS Assistant: {e}", file=sys.stderr)
        return 1
    except Exception as e:
        print(f"Error running ZFS Assistant: {e}", file=sys.stderr)
        return 1

if __name__ == '__main__':
    sys.exit(main())
